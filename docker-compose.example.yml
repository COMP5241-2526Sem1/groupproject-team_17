services:
  # Web API
  webapi:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: interactivehub-webapi
    restart: unless-stopped
    ports:
      - "9681:8080"
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
      - ASPNETCORE_URLS=http://+:8080
      - ConnectionStrings__DefaultConnection=server=YOUR_DB_SERVER;port=YOUR_PORT;database=YOUR_DATABASE;user=YOUR_USER;password=YOUR_PASSWORD
      - Auth0__Domain=YOUR_AUTH0_DOMAIN
      - Auth0__ClientId=YOUR_AUTH0_CLIENT_ID
      - Auth0__Audience=YOUR_AUTH0_AUDIENCE
      - GitHub__Token=YOUR_GITHUB_TOKEN
      - DeepSeek__ApiKey=YOUR_DEEPSEEK_API_KEY
      - DeepSeek__Model=deepseek-chat
      - LLM__Provider=DeepSeek
      - CORS__AllowedOrigins=http://localhost:9681,http://localhost:9680,http://localhost:3000
    networks:
      - interactivehub-network
    volumes:
      - webapi-logs:/app/logs

  # Frontend Web App
  webapp:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: interactivehub-webapp
    restart: unless-stopped
    ports:
      - "9680:3033"
    environment:
      - NODE_ENV=production
      - API_URL=http://localhost:9681
      - NEXT_PUBLIC_SERVER_URL=http://localhost:9681
      - AUTH0_SECRET=YOUR_AUTH0_SECRET
      - AUTH0_BASE_URL=http://localhost:9680
      - AUTH0_ISSUER_BASE_URL=https://YOUR_AUTH0_DOMAIN
      - AUTH0_DOMAIN=YOUR_AUTH0_DOMAIN
      - AUTH0_CLIENT_ID=YOUR_AUTH0_CLIENT_ID
      - AUTH0_CLIENT_SECRET=YOUR_AUTH0_CLIENT_SECRET
      - AUTH0_AUDIENCE=YOUR_AUTH0_AUDIENCE
      - AUTH0_SCOPE=openid profile email
      - APP_BASE_URL=http://localhost:9680
    networks:
      - interactivehub-network
    depends_on:
      - webapi

networks:
  interactivehub-network:
    driver: bridge

volumes:
  webapi-logs:
